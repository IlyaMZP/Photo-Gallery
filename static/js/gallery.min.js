$(function(){var e=$("#album");var b=$("#frame");var o=$("#nav");var d=b.children(".photo");var l=b.children(".title");var c=b.children(".data");var n=$("#thumbnails");var q=$("#slider");var p=q.children("span");var k=0;var i;var t;var j;$.getJSON("/gallery_json",function(v){v=JSON.parse(v);e.text(v.album.name);photos=v.photos;thumbnails="";for(var u=0;u<v.photos.length;u++){photo=v.photos[u];thumbnails+="<li><img index="+photo.id+" src=/static/"+photo.thumb_url+" alt='"+photo.title+"' title='"+photo.title+"' /></li>"}n.html(thumbnails);j=1;a(1);thumbnail=n.find("img[index='1']");m(thumbnail);n.children().each(function(){k+=$(this).outerWidth(true)});i=n.children(":first");r();g("prev",false);n.on("click","img",function(x){var w=parseInt(x.target.getAttribute("index"),10);a(w);m(x.target,w);j=w});o.on("click","button",function(x){var w=x.target.className;if(w.indexOf("prev")>=0&&j>1){j--;f()}else{if(w.indexOf("next")>=0&&j<photos.length){j++;s()}}a(j)})});$(window).on("resize",function(){r();n.children().css("display","inline-block");i=n.children(":first");g("prev",false);g("next",true)});q.on("click","span",function(x){var v=x.target.className;var w=n.children(":first");var u=h();if(v.indexOf("prev")>=0&&w.css("display")=="none"){$prev=i.prev();if($prev.length>0){i=$prev}i.css("display","inline-block");if(w[0]===i[0]){g("prev",false)}else{g("next",true)}}else{if(v.indexOf("next")>=0&&u>0){i.css("display","none");i=i.next();g("prev",true);if(h()===0){g("next",false)}}}});function a(u){if(u>0&&u<=photos.length){var v=photos[u-1];d.attr("src","/static/"+v.url);l.text(v.title);c.text("Taken on "+v.date+" in "+v.location)}}function m(u){if(t){t.removeClass("selected")}t=$(u).parent("li");t.addClass("selected")}function f(){t.removeClass("selected");t=t.prev();t.addClass("selected")}function s(){t.removeClass("selected");t=t.next();t.addClass("selected")}function r(){slider_width=q.innerWidth();if(slider_width<k&&p.css("display")=="none"){p.css("display","block")}else{if(slider_width>=k&&p.css("display")=="block"){p.css("display","none")}}}function g(u,v){$btn=q.children("."+u);if(v){$btn.removeClass("disable")}else{$btn.addClass("disable")}}function h(){var u=n.children(":last");return u.position().top}});