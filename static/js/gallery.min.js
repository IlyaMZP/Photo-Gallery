$(function(){var s=$("#header");var b=$("#frame");var o=$("#slider");var q=$("#themes");var m=$("#nav");var c=b.find(".photo");var f=b.children(".photo-caption");var l=o.children("#thumbnails");var n=o.children("span");var j=0;var h;var t;var i;$.getJSON("/gallery_json",function(v){v=JSON.parse(v);s.children(".album").text(v.album.name);photos=v.photos;thumbnails="";for(var u=0;u<v.photos.length;u++){photo=v.photos[u];thumbnails+="<li><img data-index="+photo.id+" src='/static/"+photo.thumb_url+"' alt='"+photo.title+"' title='"+photo.title+"' /></li>"}l.html(thumbnails);i=parseInt(photos[0].id,10);a(i);thumbnail=l.children(":first");k(thumbnail);l.children().each(function(){j+=$(this).outerWidth(true)});h=l.children(":first");p();e("prev",false);$("body").css("opacity","1")});l.on("click","img",function(v){$this=$(this);var u=parseInt($this.data("index"),10);a(u);k($this.parent("li"),u);i=u});m.on("click","button",function(v){var u=this.className;if(u.indexOf("prev")>=0&&i>1){i--;d()}else{if(u.indexOf("next")>=0&&i<photos.length){i++;r()}}a(i)});$(window).on("resize",function(){p();l.children().css("display","inline-block");h=l.children(":first");e("prev",false);e("next",true)});o.on("click","span",function(x){var v=x.target.className;var w=l.children(":first");var u=g();if(v.indexOf("prev")>=0&&w.css("display")=="none"){$prev=h.prev();if($prev.length>0){h=$prev}h.css("display","inline-block");if(w[0]===h[0]){e("prev",false)}else{e("next",true)}}else{if(v.indexOf("next")>=0&&u>0){h.css("display","none");h=h.next();e("prev",true);if(g()===0){e("next",false)}}}});q.on("click","span",function(u){$this=$(this);theme=$this.data("theme");if(!$this.hasClass("active")){if(theme=="another"){$('link[href="/static/css/original.min.css"]').attr({href:"/static/css/another.min.css"});m.appendTo("#frame");f.appendTo(".photo-wrapper")}else{$('link[href="/static/css/another.min.css"]').attr({href:"/static/css/original.min.css"});m.appendTo("#header");f.appendTo("#frame")}q.children(".active").removeClass("active");$this.addClass("active")}});function a(u){if(u>0&&u<=photos.length){var v=photos[u-1];c.attr("src","/static/"+v.url);f.children(".title").text(v.title);f.children(".data").text("Taken on "+v.date+" in "+v.location)}}function k(u){if(t){t.removeClass("selected")}t=$(u);t.addClass("selected")}function d(){t.removeClass("selected");t=t.prev();t.addClass("selected")}function r(){t.removeClass("selected");t=t.next();t.addClass("selected")}function p(){slider_width=o.innerWidth();if(slider_width<j&&n.css("display")=="none"){n.css("display","block")}else{if(slider_width>=j&&n.css("display")=="block"){n.css("display","none")}}}function e(u,v){$btn=o.children("."+u);if(v){$btn.removeClass("disable")}else{$btn.addClass("disable")}}function g(){var u=l.children(":last");return u.position().top}});