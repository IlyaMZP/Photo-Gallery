$(function(){function p(e){if(e>0&&e<=photos.length){var t=photos[e-1];r.attr("src","/static/"+t.url);i.text(t.title);s.text("Taken on "+t.date+" in "+t.location)}}function d(e){if(c){c.removeClass("selected")}c=$(e).parent("li");c.addClass("selected")}function v(){c.removeClass("selected");c=c.prev();c.addClass("selected")}function m(){c.removeClass("selected");c=c.next();c.addClass("selected")}function g(){slider_width=u.innerWidth();if(slider_width<f&&a.css("display")=="none"){a.css("display","block")}else if(slider_width>=f&&a.css("display")=="block"){a.css("display","none")}}var e=$("#album");var t=$("#frame");var n=$("#nav");var r=t.children(".photo");var i=t.children(".title");var s=t.children(".data");var o=$("#thumbnails");var u=$("#slider");var a=u.children("span");var f=0;var l;var c;var h;$.getJSON("/gallery_json",function(t){t=JSON.parse(t);e.text(t.album.name);photos=t.photos;thumbnails="";for(var r=0;r<t.photos.length;r++){photo=t.photos[r];thumbnails+="<li><img index="+photo.id+" src="+"/static/"+photo.thumb_url+" alt='"+photo.title+"' title='"+photo.title+"' /></li>"}o.html(thumbnails);h=1;p(1);thumbnail=o.find("img[index='1']");d(thumbnail);o.children().each(function(){f+=$(this).outerWidth(true)});l=o.children(":first");g();o.on("click","img",function(e){var t=parseInt(e.target.getAttribute("index"),10);p(t);d(e.target,t);h=t});n.on("click","button",function(e){var t=e.target.className;if(t.indexOf("prev")>=0&&h>1){h--;v()}else if(t.indexOf("next")>=0&&h<photos.length){h++;m()}p(h)})});$(window).on("resize",function(){g();o.children().css("display","inline-block");l=o.children(":first")});u.on("click","span",function(e){var t=e.target.className;var n=o.children(":last");var r=n.position().top;if(t.indexOf("prev")>=0&&l.css("display")!="None"){$prev=l.prev();if($prev.length>0){l=$prev}l.css("display","inline-block")}else if(t.indexOf("next")>=0&&r>0){l.css("display","none");l=l.next()}})})